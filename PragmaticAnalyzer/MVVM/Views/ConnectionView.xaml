<UserControl x:Class="PragmaticAnalyzer.MVVM.Views.ConnectionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:PragmaticAnalyzer.MVVM.Views"
             xmlns:assist="clr-namespace:PragmaticAnalyzer.Assistant"
             mc:Ignorable="d"
             d:Height="450"
             d:Width="800">
    <UserControl.Resources>
        <assist:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
        <assist:ListToStringConverter x:Key="ListToStringConverter" />
        <assist:EnumDescriptionConverter x:Key="EnumDescriptionConverter" />
        <Style x:Key="MainBorder"
               TargetType="Border">
            <Setter Property="BorderBrush"
                    Value="Black" />
            <Setter Property="BorderThickness"
                    Value="2" />
            <Setter Property="CornerRadius"
                    Value="5" />
            <Setter Property="Padding"
                    Value="5" />
            <Setter Property="Background"
                    Value="LightGray" />
            <Setter Property="Margin"
                    Value="5" />
        </Style>
        <Style x:Key="ParameterBorderStyle"
               TargetType="Border">
            <Setter Property="BorderBrush"
                    Value="Black" />
            <Setter Property="BorderThickness"
                    Value="2" />
            <Setter Property="Padding"
                    Value="10" />
            <Setter Property="Margin"
                    Value="5" />
            <Setter Property="Background"
                    Value="White" />
            <Setter Property="CornerRadius"
                    Value="5" />
        </Style>
        <Style x:Key="HeadingText"
               TargetType="TextBlock">
            <Setter Property="FontSize"
                    Value="15" />
            <Setter Property="FontFamily"
                    Value="Consolas" />
            <Setter Property="FontWeight"
                    Value="Bold" />
        </Style>
        <Style x:Key="DynamicText"
               TargetType="TextBlock">
            <Setter Property="FontSize"
                    Value="15" />
            <Setter Property="FontFamily"
                    Value="Consolas" />
        </Style>
        <DataTemplate x:Key="ParameterTemplateVulnerabilitie">
            <Border Style="{StaticResource ParameterBorderStyle}">
                <StackPanel>
                    <TextBlock Text="{Binding Name}"
                               Style="{StaticResource HeadingText}" />
                    <TextBlock Text="{Binding Description}"
                               Style="{StaticResource DynamicText}" />
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Источник:"
                                   FontSize="13"
                                   Margin="0 0 5 0"/>
                        <TextBlock Text="{Binding From}"
                                   FontStyle="Italic"
                                   FontSize="13" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </DataTemplate>
        <DataTemplate x:Key="ParameterTemplateTechniquesTactics">
            <Border Style="{StaticResource ParameterBorderStyle}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Техника: "
                                   Style="{StaticResource HeadingText}" />
                        <TextBlock Text="{Binding Name}"
                                   FontSize="13"
                                   FontWeight="Medium"
                                   Margin="0,0,0,5" />
                    </StackPanel>
                    <TextBlock Text="{Binding Description}"
                               Style="{StaticResource DynamicText}"
                               TextWrapping="Wrap"
                               Width="300"/>
                </StackPanel>
            </Border>
        </DataTemplate>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.2*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="0.1*" />
            <RowDefinition Height="0.3*" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0"
                   Grid.Column="0"
                   Text="Исходные данные:"
                   FontSize="15"
                   FontFamily="Consolas"
                   Margin="1"
                   TextWrapping="Wrap" />
        <Button Grid.Row="0"
                Grid.Column="1"
                Margin="1"
                Cursor="Hand"
                Command="{Binding ShowReport}">
            <TextBlock Text="Сформировать"
                       FontSize="15"
                       FontFamily="Consolas" />
        </Button>
        <Button Grid.Row="0"
                Grid.Column="2"
                Margin="1"
                Cursor="Hand"
                Command="{Binding }"
                IsEnabled="{Binding}">
            <TextBlock Text="Сохранить"
                       FontSize="15"
                       FontFamily="Consolas" />
        </Button>
        <Border Grid.Row="1"
                Grid.Column="0"
                Grid.ColumnSpan="3"
                BorderBrush="Black"
                BorderThickness="1"
                Margin="1">
            <TextBox FontSize="20"
                     Text="{Binding RequestText}" />
        </Border>
        <TextBlock Grid.Row="2"
                   Grid.Column="0"
                   Text="Коэффициент близости"
                   FontSize="15"
                   Margin="1"
                   TextWrapping="Wrap" />
        <TextBlock Grid.Row="2"
                   Grid.Column="1"
                   Grid.ColumnSpan="2"
                   Text="Отчет"
                   FontSize="30"
                   FontFamily="Consolas"
                   Margin="1"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Center" />
        <Border Grid.Row="3"
                Grid.Column="0"
                BorderThickness="1"
                BorderBrush="Black"
                CornerRadius="5"
                Padding="2">
            <ListBox ItemsSource="{Binding Reports}"
                     SelectedItem="{Binding SelectedReport}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Coefficient}"
                                   Style="{StaticResource DynamicText}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Border>
        <Border Grid.Row="3"
                Grid.Column="1"
                Grid.RowSpan="2"
                Grid.ColumnSpan="2"
                BorderBrush="Black"
                BorderThickness="1"
                CornerRadius="5"
                Padding="2">
            <ScrollViewer VerticalScrollBarVisibility="Auto"
                          Visibility="{Binding SelectedReport, Converter={StaticResource NullToVisibilityConverter}}">
                <WrapPanel Orientation="Horizontal">
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.Specialist}"
                            Visibility="{Binding SelectedReport.Specialist, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Специалист по ЗИ"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <WrapPanel>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Наименование ОВУ "
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameOrgan}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Наименование вышестоящего ОВУ "
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameHighestOrgan}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Наименование подчиненного ОВУ  "
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameHighestOrgan}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Наименование взаимодействующих ОВУ "
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameInteractingOrgans, Converter={StaticResource ListToStringConverter}}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Статус по выявленной уязвимости"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding StatusVulnerability}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Предпринятые действия"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding ActionsTaken}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Наименование СС СОПКА"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameSoftware}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Cписок принятых мер защиты"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding DisplayedUsingMeasures, Converter={StaticResource ListToStringConverter}}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                        </StackPanel>
                    </Border><!--БД Специалист по ЗИ-->
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.ReferenceStatus}"
                            Visibility="{Binding SelectedReport.ReferenceStatus, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Эталонные состояния ПФ СОПКА"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <WrapPanel>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Эталонное состояние"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameSoftware}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Время поступления ПД в систему"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding ArrivalTime, StringFormat={}{0:dd.MM.yyyy HH:mm:ss}}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                        </StackPanel>
                    </Border><!--БД Эталонные состояния ПФ СОПКА-->
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.Vulnerabilitie}"
                            Visibility="{Binding SelectedReport.Vulnerabilitie, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Уязвимостей"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <Border Style="{StaticResource ParameterBorderStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Идентификатор:"
                                               Style="{StaticResource HeadingText}"
                                               Margin="0 0 5 0" />
                                    <TextBlock Text="{Binding Identifier}"
                                               Style="{StaticResource DynamicText}" />
                                </StackPanel>
                            </Border>
                            <ItemsControl ItemsSource="{Binding Parameters}"
                                          ItemTemplate="{StaticResource ParameterTemplateVulnerabilitie}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                        </StackPanel>
                    </Border><!--БД Уязвимостей-->         
                    <Border  Style="{StaticResource MainBorder}"
                             DataContext="{Binding SelectedReport.Threat}"
                             Visibility="{Binding SelectedReport.Threat, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Угроз"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <WrapPanel>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Идентификатор угрозы"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding IdentifierUBI}"
                                                   Style="{StaticResource HeadingText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Название"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Name}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Описание"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Description}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Источник"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Source}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Объект воздействия"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding ObjectInfluence}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Нарушение конфиденциальности"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding PrivacyViolation}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Нарушение целостности"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding IntegrityViolation}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Нарушение доступности"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding AccessibilityViolation}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Дата обнаружения"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding DateInclusion}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Дата изменения"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding DateChange}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                        </StackPanel>
                    </Border><!--БД угроз-->  
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.Tactic}"
                            Visibility="{Binding SelectedReport.Tactic, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Техник и тактик"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <Border Style="{StaticResource ParameterBorderStyle}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <StackPanel Grid.Row="0"
                                                Orientation="Horizontal">
                                        <TextBlock Text="Тактика:"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Name}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                    <TextBlock Grid.Row="1"
                                               Text="{Binding Description}"
                                               Style="{StaticResource DynamicText}"/>
                                </Grid>
                            </Border>
                            <ItemsControl ItemsSource="{Binding Techniques}"
                                          ItemTemplate="{StaticResource ParameterTemplateTechniquesTactics}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                        </StackPanel>
                    </Border><!--БД Техник и тактик-->
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.ProtectionMeasure}"
                            Visibility="{Binding SelectedReport.ProtectionMeasure, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Меры защиты"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <WrapPanel>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Название группы мер защиты"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameGroup}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Название"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Name}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Описание"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Description}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Классы защищенности"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding SecurityClasses}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                        </StackPanel>
                    </Border><!--БД Меры защиты-->     
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.Technology}"
                            Visibility="{Binding SelectedReport.Technology, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Технологии оценки риска"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <WrapPanel>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Порядковый номер"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding SequenceNumber}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Метод"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding MethodName}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Описание"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Description}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Применение"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Usage}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Масштаб"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Scale}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Временной горизонт"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Horizont}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Уровень принятия решений"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Level}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Необходимость информации"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Necessity}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Опыт специалиста"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Experience}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Качество/количество"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Сharacteristic}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Применение усилий"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Effort}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                        </StackPanel>
                    </Border><!--БД Технологии оценки риска-->   
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.Consequence}"
                            Visibility="{Binding SelectedReport.Consequence, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Негативные последствия"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <WrapPanel>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Порядковый номер"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Number}"
                                                   Style="{StaticResource DynamicText}"/>
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Наименование"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Name}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Ущерб"
                                                   Style="{StaticResource HeadingText}"/>
                                        <TextBlock Text="{Binding Damage}"
                                                   Style="{StaticResource DynamicText}"/>
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Угрозы"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding NameThreats, Converter={StaticResource ListToStringConverter}}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                        </StackPanel>
                    </Border><!--БД Негативные последствия-->
                    <Border Style="{StaticResource MainBorder}"
                            DataContext="{Binding SelectedReport.Violator}"
                            Visibility="{Binding SelectedReport.Violator, Converter={StaticResource NullToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Text="Источник знаний: БД Нарушителей"
                                       Style="{StaticResource HeadingText}"
                                       FontSize="20"
                                       Margin="5" />
                            <WrapPanel>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Идентификатор"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding DisplayedId}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Источник угрозы"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Source, Converter={StaticResource EnumDescriptionConverter}}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Потенциал"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Potential, Converter={StaticResource EnumDescriptionConverter}}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Цель атаки"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding Target}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Используемые инструменты"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding UsingTools}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                                <Border Style="{StaticResource ParameterBorderStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Данные о предыдущих атаках"
                                                   Style="{StaticResource HeadingText}" />
                                        <TextBlock Text="{Binding PreviousAttacks}"
                                                   Style="{StaticResource DynamicText}" />
                                    </StackPanel>
                                </Border>
                            </WrapPanel>
                        </StackPanel>
                    </Border><!--БД Нарушителей-->
                </WrapPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>